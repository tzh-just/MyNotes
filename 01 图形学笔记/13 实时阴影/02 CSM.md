远处的物体投射的阴影在屏幕空间中只占几个像素，而近处的物体投射的阴影可能会占据屏幕的很大一部分。
在一个阴影地图中捕捉所有内容需要非常高且不切实际的分辨率，通过 CSM 可以将相机视锥体分为若干块，每一部分都生成单独的深度缓冲。
在近处的部分生成较高精度的 shadowmap，远处的部分使用较低精度的 shadowmap。CSM 常用于大场景中模拟太阳光的平行光阴影。
如图所示为 RenderDoc 截帧得到的四级 Shadowmap，最大阴影范围 100，线性切分比例为 0.1，0.2，0.3，0.4。

![](Pasted%20image%2020230717164811.png)

将视锥划按以上比例划分为四块，根据相机视锥切分的部分和平行光的方向，生成合适的正交投影矩阵，渲染场景，得到不同层级的深度缓冲，例如先求出截锥体的包围盒，计算包围盒的中心点，设置近平面为-500，远平面为 500。

![](CSM.png)

【优化】场景中物体在远距离的级联阴影中变化不大，因此可以对不同层级的阴影设定不同的更新率，平摊到每帧后降低了投影物体数量。