### irradiance 和 radiance 的区别，量纲分别是什么，二者的表达式；

radiance的物理意义是每单位面积每单位立体角接收到的功率。 irradiance的物理意义是每单位面积接收到的所有能量，即radiance在半球面上的积分。

对于radiance，其表达式为
$$
L=\frac{d^{2} \Phi}{\cos \theta d A d \omega}
$$
对于irradiance来说，radiance在半球面上积分，同样要考虑投影角度
$$
E = \int_{\Omega} L(\omega) cos \theta d\omega 
$$

### 写出渲染方程，解释每项的含义

$$
L_{o}\left(p, \omega_{o}\right)=L_{e}\left(p, \omega_{o}\right)+\int_{\Omega^{+}} L_{i}\left(p, \omega_{i}\right) f_{r}\left(p, \omega_{i}, \omega_{o}\right)\left(n \cdot \omega_{i}\right) \mathrm{d} \omega_{i}
$$

$L_o$是着色点p在出射方向$w_o$上的radiance，$L_e$是物体表面自发光在出射方向$w_o$上的radiance，积分式中，$L_i$是着色点$p$在入射方向$w_i$上的radiance，$f_r$是反射分布函数，其定义是出射radiance的微分与入射irradiance的微分之比。$\cos$项是入射方向与法线的夹角余弦。



### 写出 Cook-Torrance BRDF 公式


$$
f_r= k_d  \frac{c}{\pi}+k_s\frac{D(\omega_h)F_r(\omega_o)G(\omega_o,\omega_i)}{4 cos\theta_o cos\theta_i}
$$

### 兰伯特项为什么要除以 PI

对于漫反射项，假设入射光时均匀分布整个半球体，因此其入射 Irradiance 转换到出射 Radiance 的过程与入射方向无关，即 BRDF 和 $L_i$ 都是一个常数项：
$$
L_o(\omega_o)= f_rL_i\int_{H^{2}}{{cos\theta_i}d\omega_i}
$$
积分项中$d\omega = dA/r^2 = sin\theta d\theta d\phi$，将积分式转换为二重积分
$$
\int_{\Omega}cos\theta d\omega = \int_{0}^{2\pi}\int_{0}^{\frac{\pi}{2}}{cos\theta sin\theta} {d\theta} {d\phi}
$$
令$u=\cos \theta, du=-\sin\theta d\theta$，则
$$
\begin{aligned}
\int_{0}^{\frac{\pi}{2}} \cos \theta \sin \theta d \theta & =-\int_{1}^{0} u d u =\frac{1}{2}
\end{aligned}
$$
带入原式可得
$$
\frac{1}{2}\int_{0}^{2\pi}d\phi = \pi
$$
除以$\pi$后可以，可以规定一个[0-1]的漫反射常系数。



解释镜面反射项

D项是法向量和半程向量h的夹角的分布函数，其的定义是每单位面积、每单位立体角上所有法线方向为 $h$ 的微表面的面积比，

F表示镜面发射和折射发生比例的Fresnel反射系数

G表示几何遮挡函数。



漫反射项和镜面反射项的权重取决于什么；







