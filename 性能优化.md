
在项目进行100只怪物的同屏测试时有明显掉帧，通过state unit命令发现是cpu的耗时很高，经过unreal insight的分析发现是ai行为树调用的函数耗时很高，但是具体是哪些方法无法确定。对行为树进行排查后发现是寻敌逻辑实现的问题。建议客户端把getactorbyactor的机制改为玩家池后从6.ms降低到了3.ms，另外寻敌逻辑是不需要tick执行的，将寻敌改写为service节点后，减少tick后降低到了1.ms。


某次打包实机时手机端很卡，经过分析是gpu端的压力，排查后发现是因为美术实现的悬崖风沙效果，原理是制作了一个全场景覆盖的面片，在材质里通过motion texture和uv偏移实现的风沙移动、随机透明度、颜色等，在PC上影响不大，但是在移动端上gpu架构的不同，风沙纹理有大面积的透明像素，需要回读system memory上的framebuffer，来做透明度混合，这会大幅降低性能，最后通过将全场景覆盖的大面片改为多个预制的小面片，减少透明像素覆盖的tile数量，以及做一些LOD分级，移动端不采样噪声纹理不做随机处理。
